---
layout: post
title: 'Android Reverse Engineering Tutorial#1: Disassembling and Decompiling DEX
  files'
date: '2013-01-21T01:21:00.001+05:30'
author: Shubham Aher
tags:
- java
- cracking
- reverse engineering
- tutorial
- android
modified_time: '2013-01-31T10:12:19.328+05:30'
thumbnail: http://4.bp.blogspot.com/-4MMv6AmhKrU/UPwyWEMtj1I/AAAAAAAAAEY/NT93GkQiPcE/s72-c/sshot-1.png
blogger_id: tag:blogger.com,1999:blog-2487333153967243269.post-2229337329372855976
blogger_orig_url: http://shubhamaher.blogspot.com/2013/01/android-reverse-engineering-tutorial1.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><h4 style="text-align: left;"><u><b>Aim</b>:</u></h4><div dir="ltr" trbidi="on"><div trbidi="on">To learn to:<br /><ol style="text-align: left;"><li>Decompile the <a href="http://en.wikipedia.org/wiki/APK_%28file_format%29" target="_blank">Android App File (.<b>apk</b>)</a> into Java code (.java)</li><li>Disassemble the <a href="http://en.wikipedia.org/wiki/Dalvik_%28software%29" target="_blank">Dex File (.dex)</a> into <a href="http://pallergabor.uw.hu/androidblog/dalvik_opcodes.html" target="_blank">Dalvik Opcodes (.smali)</a></li><li>Use of tools like <a href="http://developer.android.com/tools/help/adb.html" target="_blank">adb(Android Debug Bridge)</a>, <a href="http://code.google.com/p/dex2jar/" target="_blank">dex2jar</a>, <a href="http://java.decompiler.free.fr/?q=jdgui" target="_blank">jd-gui</a>, etc.</li></ol>Besides above things, this tutorial introduces you to the basics of <a href="http://en.wikipedia.org/wiki/Reverse_engineering" target="_blank">reverse engineering</a> on Android platform.<br /><h4><u><br /></u></h4><h4><u>Tools Needed:</u></h4><ul><li><a href="http://developer.android.com/sdk/index.html" target="_blank">Android SDK</a> (for adb and Emulators )</li><li><span style="background-color: white;"><a href="http://www.mediafire.com/download.php?86e1th638ztn71a" target="_blank">EasyAPKDisassembler</a> ( Its batch utility created by some <a href="http://www.xda-developers.com/" target="_blank">XDA</a> member that supports disassembling, converting binary XML to textual XML, APKtool assembly/disassembly, Signing/Designing Certificates, etc)</span></li><li><span style="background-color: white;"><a href="http://code.google.com/p/dex2jar/" target="_blank">Dex2jar</a></span></li><li><span style="background-color: white;"><a href="http://www.rarlab.com/download.htm" target="_blank">WinRAR</a> or any archive tool (with .zip file support)</span></li><li><a href="http://java.decompiler.free.fr/?q=jdgui" target="_blank">jd-gui</a> or any <a href="http://en.wikipedia.org/wiki/Category:Java_decompilers" target="_blank">other</a> Java decompiler.</li></ul><ul></ul><h4><u>Steps for DISASSEMBLING (.dex to .smali) :</u></h4><span style="background-color: white;">1. Copy the target APK file ( <a href="http://www.mediafire.com/download.php?55hkqivhjhondg0">TestHelloWorld.apk</a> ) to <b>"platform-tools"</b> folder inside the main <b>"android-sdk"</b> folder. For e.g. On my machine Android SDK is in <b>"</b></span><span style="background-color: white;"><b>D:\Program Files(x86)\Android\android-sdk\platform-tools"</b></span><br /><b><br /></b><span style="background-color: white;">2. Copy the </span><b>Command Prompt(cmd.exe)</b><span style="background-color: white;"> from your system files into </span><b>"platform-tools"</b><span style="background-color: white;"> folder and double click it to type following commands:</span><br /><ol></ol></div><pre class="brush: shell">D:\Program Files (x86)\Android\android-sdk\platform-tools&gt;adb devices<br />List of devices attached<br />emulator-5554   device<br /><br />D:\Program Files (x86)\Android\android-sdk\platform-tools&gt;adb install TestHelloW<br />orld.apk<br />24 KB/s (5546 bytes in 0.220s)<br />        pkg: /data/local/tmp/TestHelloWorld.apk<br />Success<br /></pre><br />3. <b>"adb devices"</b> tells us the list of <b>running emulators</b>.<br /><br />4. We install the <b>APK package</b> with <b>"adb install TestHelloWorld.apk"</b> command.<br /><br />5. Lets check and see the app in emulator:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-4MMv6AmhKrU/UPwyWEMtj1I/AAAAAAAAAEY/NT93GkQiPcE/s1600/sshot-1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="366" src="http://4.bp.blogspot.com/-4MMv6AmhKrU/UPwyWEMtj1I/AAAAAAAAAEY/NT93GkQiPcE/s400/sshot-1.png" width="400" /></a></div><br />6. <a href="http://www.mediafire.com/download.php?86e1th638ztn71a">Download</a> and extract <b>"<a href="http://www.mediafire.com/download.php?86e1th638ztn71a">EasyApkDisassembler.V1.3.1.zip</a>"</b> in a folder <b>anywhere </b>you like. Also copy the <b>"<a href="http://www.mediafire.com/download.php?55hkqivhjhondg0">TestHelloWorld.apk</a>"</b> in the <b>same </b>folder.<br /><br />7. Open <b>"<a href="http://www.mediafire.com/download.php?55hkqivhjhondg0">TestHelloWorld.apk</a>"</b> with <b>WinRAR </b>or any other <b>archive tool</b> that supports the <b>ZIP format</b> as <b>.APK</b> is nothing but a <b>.ZIP file with a different extension</b>. From this file extract the <b>"classes.dex"</b> into the same dir where you extracted the<b> "EasyApkDisassembler.V1.3.1.zip"</b> files :<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-UFMXXgA2BiI/UPw2jrVWRTI/AAAAAAAAAEo/bc_THMeD0nw/s1600/sshot-2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="208" src="http://1.bp.blogspot.com/-UFMXXgA2BiI/UPw2jrVWRTI/AAAAAAAAAEo/bc_THMeD0nw/s640/sshot-2.png" width="640" /></a></div><br />8. Start&nbsp;<b>"EasyApkDisassembler.EN.bat"</b> , press <b>option 2</b> and give the name of the file as <b>"TestHelloWorld.apk"</b> :<br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-xBsP5ojT_cI/UPw3ajLcPGI/AAAAAAAAAE4/4-CELRV_iEg/s1600/sshot-2013-01-20-%5B23-56-02%5D.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://3.bp.blogspot.com/-xBsP5ojT_cI/UPw3ajLcPGI/AAAAAAAAAE4/4-CELRV_iEg/s640/sshot-2013-01-20-%5B23-56-02%5D.png" width="640" /></a></div><br />9. Now the<b> "classes.dex"</b> file is <b>disassembled </b>into the same folder with a name as <b>"out_TestHelloWorld.apk"</b>. This folder contains all the disassembled source code in <a href="http://pallergabor.uw.hu/androidblog/dalvik_opcodes.html"><b>Dalvik Opcodes</b> format </a>(.<b>smali</b>) files :<br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-csJk5CaxXiU/UPw5D08U70I/AAAAAAAAAFQ/Idp0QUT4q-E/s1600/sshot-2013-01-21-%5B00-03-47%5D.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-csJk5CaxXiU/UPw5D08U70I/AAAAAAAAAFQ/Idp0QUT4q-E/s1600/sshot-2013-01-21-%5B00-03-47%5D.png" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div>10. Navigate to <b>"\out_TestHelloWorld.apk\com\example\android\helloactivity\"</b> :<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-bHsNUGURRYk/UPw6dli1HpI/AAAAAAAAAFg/oWj267Y_8M8/s1600/sshot-2013-01-21-%5B00-10-43%5D.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="115" src="http://2.bp.blogspot.com/-bHsNUGURRYk/UPw6dli1HpI/AAAAAAAAAFg/oWj267Y_8M8/s640/sshot-2013-01-21-%5B00-10-43%5D.png" width="640" /></a></div><br />11. You will see many .<b>smali </b>files. Open the <b>"HelloActivity.smali"</b> file in <b>Notepad </b>or any other text editor you like :<br /><br /></div></div><pre class="brush: plain">.class public Lcom/example/android/helloactivity/HelloActivity;<br />.super Landroid/app/Activity;<br />.source "HelloActivity.java"<br /><br /><br /># direct methods<br />.method public constructor <init>()V<br />    .registers 1<br /><br />    .prologue<br />    .line 27<br />    invoke-direct {p0}, Landroid/app/Activity;-&gt;<init>()V<br /><br />    .line 28<br />    return-void<br />.end method<br /><br /><br /># virtual methods<br />.method public onCreate(Landroid/os/Bundle;)V<br />    .registers 3<br />    .parameter "savedInstanceState"<br /><br />    .prologue<br />    .line 35<br />    invoke-super {p0, p1}, Landroid/app/Activity;-&gt;onCreate(Landroid/os/Bundle;)V<br /><br />    .line 39<br />    const/high16 v0, 0x7f02<br /><br />    invoke-virtual {p0, v0}, Lcom/example/android/helloactivity/HelloActivity;-&gt;setContentView(I)V<br /><br />    .line 40<br />    return-void<br />.end method<br /><br /></init></init></pre>12. You have successfully <b>disassembled </b>the .<b>dex </b>file into .<b>smali </b>file. In order to <b>understand </b>the .<b>smali </b>code you will need to go through the <u><i><b><a href="http://pallergabor.uw.hu/androidblog/dalvik_opcodes.html" target="_blank">Dalvik Opcodes List</a></b></i></u>.<br /><br />13. The <b>disassembled </b>file in .<b>smali </b>format is very <b>easy </b>to <b>patch</b>. In my <b>upcoming Android reversing tutorials</b> I will be covering <b>patching </b>the <b><a href="http://pallergabor.uw.hu/androidblog/dalvik_opcodes.html">Dalvik Bytecodes</a></b>.<br /><br /><h4><u>Steps for DECOMPILING (.dex to .java) :</u></h4><div><u><br /></u></div><div>1. <b><a href="http://code.google.com/p/dex2jar/downloads/list">Download</a></b> latest copy of "<b>dex2jar</b>" tool and extract its content in the <b>same </b>folder where you extracted the <b>"EasyApkDisassembler.V1.3.1.zip"</b> files as in <b>above </b>part. Also copy the same <b>"classes.dex"</b> into <b>"dex2jar-0.0.9.6"</b> folder :</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-TCAiBCB5NAI/UPw-gqxszOI/AAAAAAAAAFw/FqZlAPAg1yQ/s1600/sshot-2013-01-21-%5B00-28-06%5D.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="203" src="http://4.bp.blogspot.com/-TCAiBCB5NAI/UPw-gqxszOI/AAAAAAAAAFw/FqZlAPAg1yQ/s640/sshot-2013-01-21-%5B00-28-06%5D.png" width="640" /></a></div><div><br />2. Within the <b>"dex2jar-0.0.9.6"</b> folder, open the command prompt and type following command :</div></div><pre class="brush: plain">dex2jar classes.dex<br /></pre><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-p0rkZGffpiA/UPxDK5J8rgI/AAAAAAAAAGM/0Ywz09GS5tc/s1600/sshot-2013-01-21-%5B00-34-20%5D.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="107" src="http://1.bp.blogspot.com/-p0rkZGffpiA/UPxDK5J8rgI/AAAAAAAAAGM/0Ywz09GS5tc/s640/sshot-2013-01-21-%5B00-34-20%5D.png" width="640" /></a></div><br />3. After the command <b>completes </b>you will see the <b>"classes_dex2jar.jar"</b> file in the <b>same folder</b>. You can extract this <b>.jar file</b> into a folder you like and you will see <b>many .class files</b>. Open the <b>"HelloActivity.class"</b> file in <b>"jd-gui"</b> or any other java decompiler you like :<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-XvDB-0BxVWc/UPxCcCA-QAI/AAAAAAAAAGA/eRaRFf2o8T4/s1600/sshot-2013-01-21-%5B00-43-27%5D.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-XvDB-0BxVWc/UPxCcCA-QAI/AAAAAAAAAGA/eRaRFf2o8T4/s1600/sshot-2013-01-21-%5B00-43-27%5D.png" /></a></div><br />4. You have successfully <b>decompiled </b>the .<b>dex </b>file into .<b>java </b>file.<br /><br /><h4 style="text-align: left;"><b><u>Download Links:</u></b></h4>1.&nbsp;<b>EasyAPKDisassembler</b>:<br /><b><a href="http://www.mediafire.com/download.php?86e1th638ztn71a">http://www.mediafire.com/download.php?86e1th638ztn71a</a></b> or<br /><b><a href="http://code.google.com/p/easy-apk-dissassembler/downloads/detail?name=EasyApkDisassembler.V1.3.1.zip&amp;can=2&amp;q=">http://code.google.com/p/easy-apk-dissassembler/downloads/detail?name=EasyApkDisassembler.V1.3.1.zip&amp;can=2&amp;q=</a></b><br /><br />2.&nbsp;<b>Dex2jar</b>:<br /><b><a href="http://code.google.com/p/dex2jar/downloads/detail?name=dex2jar-0.0.9.12-a.zip&amp;can=2&amp;q=">http://code.google.com/p/dex2jar/downloads/detail?name=dex2jar-0.0.9.12-a.zip&amp;can=2&amp;q=</a></b><br /><br />3. <b>WinRAR</b>:<br /><b><a href="http://www.rarlab.com/rar/wrar420.exe">http://www.rarlab.com/rar/wrar420.exe</a></b><br /><br />4.&nbsp;<b>jd-gui</b>:<br /><b><a href="http://jd.benow.ca/jd-gui/downloads/jd-gui-0.3.5.windows.zip">http://jd.benow.ca/jd-gui/downloads/jd-gui-0.3.5.windows.zip</a>&nbsp;</b></div></div>